<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Percentage calculator</title>
  <style>
    * { box-sizing: border-box; }
    body, input { -webkit-user-select: text; user-select: text; font-family: system-ui, sans-serif; }
    body { margin: 0; padding: 1rem; background: #fff; color: #1a1a1a; font-size: 0.95rem; }
    h1 { font-size: 1.25rem; margin: 0 0 0.5rem 0; }
    h2 { font-size: 1rem; margin: 1.25rem 0 0.5rem 0; color: #333; }
    label { display: block; margin-bottom: 0.25rem; font-weight: 500; }
    .row { margin-bottom: 1rem; }
    input[type="text"] { padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; width: 10rem; font-family: ui-monospace, monospace; }
    input:focus { outline: none; border-color: #1a73e8; }
    .input-row { display: flex; align-items: baseline; gap: 0.5rem; flex-wrap: wrap; }
    .calc-block { background: #f8f9fa; border-radius: 8px; padding: 1rem; margin-bottom: 1rem; }
    .calc-block h2 { margin: 0 0 0.75rem 0; font-size: 0.95rem; }
    .result { margin-top: 0.75rem; font-size: 1.1rem; font-family: ui-monospace, monospace; font-weight: 500; color: #1a73e8; }
    .result.empty { color: #999; font-weight: normal; }
    .result.error { color: #c00; }
    .formula { font-size: 0.8rem; color: #666; margin-top: 0.25rem; }
    .note { font-size: 0.85rem; color: #555; margin: 0 0 1rem 0; }
  </style>
</head>
<body>
  <h1>Percentage calculator</h1>
  <p class="note">Calculate <strong>x% of y</strong>, or <strong>what percent x is of y</strong>, and the reverse (from value).</p>

  <div class="calc-block">
    <h2>1. What is <em>x</em>% of <em>y</em>?</h2>
    <div class="row">
      <label for="pctOf">Percent (%)</label>
      <div class="input-row">
        <input type="text" id="pctOf" placeholder="e.g. 20" inputmode="decimal" autocomplete="off" />
        <span>% of</span>
      </div>
    </div>
    <div class="row">
      <label for="valueOf">Value (<em>y</em>)</label>
      <div class="input-row">
        <input type="text" id="valueOf" placeholder="e.g. 500" inputmode="decimal" autocomplete="off" />
      </div>
    </div>
    <p class="result" id="resultOf">—</p>
    <p class="formula" id="formulaOf">Result = (percent ÷ 100) × value</p>
  </div>

  <div class="calc-block">
    <h2>2. <em>x</em> is what percent of <em>y</em>?</h2>
    <div class="row">
      <label for="isVal">Value (<em>x</em>)</label>
      <div class="input-row">
        <input type="text" id="isVal" placeholder="e.g. 100" inputmode="decimal" autocomplete="off" />
        <span>is what % of</span>
      </div>
    </div>
    <div class="row">
      <label for="isTotal">Total (<em>y</em>)</label>
      <div class="input-row">
        <input type="text" id="isTotal" placeholder="e.g. 500" inputmode="decimal" autocomplete="off" />
      </div>
    </div>
    <p class="result" id="resultIs">—</p>
    <p class="formula" id="formulaIs">Percent = (value ÷ total) × 100</p>
  </div>

  <div class="calc-block">
    <h2>3. <em>y</em> is <em>x</em>% of what number?</h2>
    <div class="row">
      <label for="fromVal">Value (<em>y</em>)</label>
      <div class="input-row">
        <input type="text" id="fromVal" placeholder="e.g. 50" inputmode="decimal" autocomplete="off" />
        <span>is</span>
      </div>
    </div>
    <div class="row">
      <label for="fromPct">Percent (%)</label>
      <div class="input-row">
        <input type="text" id="fromPct" placeholder="e.g. 25" inputmode="decimal" autocomplete="off" />
        <span>% of what?</span>
      </div>
    </div>
    <p class="result" id="resultFrom">—</p>
    <p class="formula" id="formulaFrom">Total = value ÷ (percent ÷ 100)</p>
  </div>

  <script>
(function () {
  var pctOf = document.getElementById('pctOf');
  var valueOf = document.getElementById('valueOf');
  var resultOf = document.getElementById('resultOf');
  var formulaOf = document.getElementById('formulaOf');

  var isVal = document.getElementById('isVal');
  var isTotal = document.getElementById('isTotal');
  var resultIs = document.getElementById('resultIs');
  var formulaIs = document.getElementById('formulaIs');

  var fromVal = document.getElementById('fromVal');
  var fromPct = document.getElementById('fromPct');
  var resultFrom = document.getElementById('resultFrom');
  var formulaFrom = document.getElementById('formulaFrom');

  function parseNum(s) {
    if (s == null || (s = String(s).trim()) === '') return NaN;
    var n = parseFloat(s.replace(/,/g, ''));
    return isFinite(n) ? n : NaN;
  }

  function syncUrl() {
    var params = new URLSearchParams(window.location.search);
    var p1 = pctOf.value.trim();
    var v1 = valueOf.value.trim();
    var p2 = isVal.value.trim();
    var t2 = isTotal.value.trim();
    var v3 = fromVal.value.trim();
    var p3 = fromPct.value.trim();
    if (p1) params.set('pct', p1);
    else params.delete('pct');
    if (v1) params.set('of', v1);
    else params.delete('of');
    if (p2) params.set('is', p2);
    else params.delete('is');
    if (t2) params.set('total', t2);
    else params.delete('total');
    if (v3) params.set('fromVal', v3);
    else params.delete('fromVal');
    if (p3) params.set('fromPct', p3);
    else params.delete('fromPct');
    var qs = params.toString();
    var url = window.location.pathname + (qs ? '?' + qs : '');
    if (window.parent !== window) {
      window.parent.postMessage({ type: 'helpers-set-query', query: Object.fromEntries(params) }, '*');
    } else {
      window.history.replaceState(null, '', url);
    }
  }

  function runOf() {
    var p = parseNum(pctOf.value);
    var v = parseNum(valueOf.value);
    if (isNaN(p) || isNaN(v)) {
      resultOf.textContent = '—';
      resultOf.className = 'result empty';
      formulaOf.textContent = 'Result = (percent ÷ 100) × value';
      return;
    }
    var r = (p / 100) * v;
    resultOf.textContent = p + '% of ' + v + ' = ' + r;
    resultOf.className = 'result';
    formulaOf.textContent = '(' + p + ' ÷ 100) × ' + v + ' = ' + r;
  }

  function runIs() {
    var x = parseNum(isVal.value);
    var y = parseNum(isTotal.value);
    if (isNaN(x) && isNaN(y)) {
      resultIs.textContent = '—';
      resultIs.className = 'result empty';
      formulaIs.textContent = 'Percent = (value ÷ total) × 100';
      return;
    }
    if (isNaN(y) || y === 0) {
      resultIs.textContent = 'Total must be a non-zero number';
      resultIs.className = 'result error';
      formulaIs.textContent = 'Percent = (value ÷ total) × 100';
      return;
    }
    if (isNaN(x)) {
      resultIs.textContent = '—';
      resultIs.className = 'result empty';
      formulaIs.textContent = 'Percent = (value ÷ total) × 100';
      return;
    }
    var p = (x / y) * 100;
    resultIs.textContent = x + ' is ' + p + '% of ' + y;
    resultIs.className = 'result';
    formulaIs.textContent = '(' + x + ' ÷ ' + y + ') × 100 = ' + p + '%';
  }

  function runFrom() {
    var v = parseNum(fromVal.value);
    var p = parseNum(fromPct.value);
    if (isNaN(v) || isNaN(p)) {
      resultFrom.textContent = '—';
      resultFrom.className = 'result empty';
      formulaFrom.textContent = 'Total = value ÷ (percent ÷ 100)';
      return;
    }
    if (p === 0) {
      resultFrom.textContent = 'Percent must be non-zero';
      resultFrom.className = 'result error';
      formulaFrom.textContent = 'Total = value ÷ (percent ÷ 100)';
      return;
    }
    var t = v / (p / 100);
    resultFrom.textContent = v + ' is ' + p + '% of ' + t;
    resultFrom.className = 'result';
    formulaFrom.textContent = v + ' ÷ (' + p + ' ÷ 100) = ' + t;
  }

  function run() {
    runOf();
    runIs();
    runFrom();
    syncUrl();
  }

  [pctOf, valueOf, isVal, isTotal, fromVal, fromPct].forEach(function (el) {
    el.addEventListener('input', run);
    el.addEventListener('change', run);
  });

  (function initFromUrl() {
    var params = new URLSearchParams(window.location.search);
    var pct = params.get('pct');
    var of = params.get('of');
    var is = params.get('is');
    var total = params.get('total');
    var fromValP = params.get('fromVal');
    var fromPctP = params.get('fromPct');
    if (pct != null) pctOf.value = pct;
    if (of != null) valueOf.value = of;
    if (is != null) isVal.value = is;
    if (total != null) isTotal.value = total;
    if (fromValP != null) fromVal.value = fromValP;
    if (fromPctP != null) fromPct.value = fromPctP;
    run();
  })();
})();
  </script>
</body>
</html>
